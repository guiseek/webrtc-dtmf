const C=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const g of r.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}};C();function a(e,t=document.body){return t.querySelector(e)}function w(e,t=document.body){return t.querySelectorAll(e)}const h=a("button#callButton"),u=a("button#sendTonesButton"),f=a("button#hangupButton"),p=a("input#duration"),m=a("input#gap"),L=a("input#tones"),S=a("span#durationValue"),D=a("span#gapValue"),k=a("input#sentTones"),y=a("div#dtmfStatus"),b=a("audio");let c,i,d,s;const E={offerToReceiveAudio:!0,offerToReceiveVideo:!1};p.oninput=()=>{S.textContent=p.value};m.oninput=()=>{D.textContent=m.value};async function O(){x(),u.disabled=!0,f.disabled=!0,h.addEventListener("click",()=>M()),u.addEventListener("click",()=>B()),f.addEventListener("click",()=>I())}async function A(e){console.log("Received local stream"),d=e;const t=d.getAudioTracks();t.length>0&&console.log(`Using Audio device: ${t[0].label}`),d.getTracks().forEach(n=>c.addTrack(n,d)),console.log("Adding Local Stream to peer connection");try{const n=await c.createOffer(E);await R(n)}catch(n){console.log("Failed to create session description:",n)}}async function M(){console.log("Starting call"),c=new RTCPeerConnection({}),console.log("Created local peer connection object pc1"),c.addEventListener("icecandidate",e=>v(c,e)),i=new RTCPeerConnection({}),console.log("Created remote peer connection object pc2"),i.addEventListener("icecandidate",e=>v(i,e)),i.addEventListener("track",e=>P(e)),console.log("Requesting local stream");try{const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});await A(e)}catch(e){console.log("getUserMedia() error:",e)}h.disabled=!0,f.disabled=!1,u.disabled=!1}async function R(e){console.log(`Offer from pc1
${e.sdp}`),c.setLocalDescription(e),i.setRemoteDescription(e);try{const t=await i.createAnswer();F(t)}catch(t){console.log("Failed to create session description:",t)}}function F(e){i.setLocalDescription(e),console.log(`Answer from pc2:
${e.sdp}`),c.setRemoteDescription(e)}function I(){console.log("Ending call"),c.close(),i.close(),c=null,i=null,d=null,s=null,h.disabled=!1,f.disabled=!0,u.disabled=!0,y.textContent="DTMF deactivated"}function P(e){if(b.srcObject!==e.streams[0]){if(b.srcObject=e.streams[0],console.log("Received remote stream"),!c.getSenders){alert("This demo requires the RTCPeerConnection method getSenders() which is not support by this browser.");return}const n=c.getSenders().find(l=>l.track&&l.track.kind==="audio");if(!n){console.log(`No local audio track to send DTMF with
`);return}if(!n.dtmf){alert("This demo requires DTMF which is not support by this browser.");return}s=n.dtmf,y.textContent="DTMF available",console.log(`Got DTMFSender
`),s.ontonechange=N}}function q(e){return e===c?i:c}function $(e){return e===c?"pc1":"pc2"}async function v(e,t){try{await q(e).addIceCandidate(t.candidate),console.log(`${$(e)} ICE candidate: ${t.candidate?t.candidate.candidate:"(null)"}`)}catch(n){console.log("Error adding ice candidate:",n)}}function N(e){e&&(console.log(`Sent DTMF tone: ${e.tone}`),k.value+=`${e.tone} `)}function T(e){if(s&&s.canInsertDTMF){const t=p.valueAsNumber,n=m.valueAsNumber;console.log("Tones, duration, gap: ",e,t,n),s.insertDTMF(e,t,n)}}function B(){T(L.value)}function x(){const e=a("div#dialPad");w("button",e).forEach(n=>{n.addEventListener("click",()=>{T(`${n.textContent}`)})})}document.addEventListener("DOMContentLoaded",O);
